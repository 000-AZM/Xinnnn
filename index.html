function loadFriendRequests() {
  const uid = getCurrentUid();
  if (!uid) return;

  const listDiv = document.getElementById('friendRequestsList');
  listDiv.innerHTML = 'Loading...';

  db.collection('friendRequests')
    .where('to', '==', uid)
    .where('status', '==', 'pending')
    .orderBy('timestamp', 'desc')
    .get()
    .then(snapshot => {
      if (snapshot.empty) {
        listDiv.innerHTML = '<p>No pending requests.</p>';
        return;
      }

      let html = '';
      let promises = [];

      snapshot.forEach(doc => {
        const data = doc.data();
        const requestId = doc.id;
        promises.push(
          db.collection('users').doc(data.from).get().then(userDoc => {
            const user = userDoc.data() || { name: "Unknown" };
            html += `
              <div class="request-item" style="display:flex; justify-content:space-between; align-items:center; padding:8px; border-bottom:1px solid #ddd;">
                <span>${escapeHtml(user.name)}</span>
                <div>
                  <button onclick="acceptFriendRequest('${requestId}', '${data.from}')">Accept</button>
                  <button onclick="declineFriendRequest('${requestId}')">Decline</button>
                </div>
              </div>
            `;
          })
        );
      });

      Promise.all(promises).then(() => {
        listDiv.innerHTML = html;
      });
    })
    .catch(e => {
      listDiv.innerHTML = `<p style="color:red;">Error loading requests: ${e.message}</p>`;
      console.error(e);
    });
}
